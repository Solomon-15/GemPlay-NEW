/workspace/backend/server.py:1851: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
/workspace/backend/server.py:2601: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("shutdown")
/workspace/backend/server.py:3960: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
INFO:     Started server process [6709]
INFO:     Waiting for application startup.
2025-08-17 06:24:36,064 - __main__ - INFO - Starting GemPlay API...
2025-08-17 06:24:36,064 - __main__ - INFO - Initializing default gems with updated icons...
ERROR:    Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py", line 732, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               ~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py", line 608, in __aenter__
    await self._router.startup()
  File "/home/ubuntu/.local/lib/python3.13/site-packages/starlette/routing.py", line 709, in startup
    await handler()
  File "/workspace/backend/server.py", line 1857, in startup_event
    await initialize_default_gems()
  File "/workspace/backend/server.py", line 1776, in initialize_default_gems
    delete_result = await db.gem_definitions.delete_many({"name": {"$in": default_gem_names}})
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/ubuntu/.local/lib/python3.13/site-packages/pymongo/collection.py", line 1464, in delete_many
    self._delete_retryable(
    ~~~~~~~~~~~~~~~~~~~~~~^
        filter,
        ^^^^^^^
    ...<6 lines>...
        comment=comment,
        ^^^^^^^^^^^^^^^^
    ),
    ^
  File "/home/ubuntu/.local/lib/python3.13/site-packages/pymongo/collection.py", line 1339, in _delete_retryable
    return self.__database.client._retryable_write(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        (write_concern or self.write_concern).acknowledged and not multi, _delete, session
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/ubuntu/.local/lib/python3.13/site-packages/pymongo/mongo_client.py", line 1567, in _retryable_write
    with self._tmp_session(session) as s:
         ~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/usr/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/home/ubuntu/.local/lib/python3.13/site-packages/pymongo/mongo_client.py", line 1885, in _tmp_session
    s = self._ensure_session(session)
  File "/home/ubuntu/.local/lib/python3.13/site-packages/pymongo/mongo_client.py", line 1868, in _ensure_session
    return self.__start_session(True, causal_consistency=False)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/.local/lib/python3.13/site-packages/pymongo/mongo_client.py", line 1811, in __start_session
    self._topology._check_implicit_session_support()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/ubuntu/.local/lib/python3.13/site-packages/pymongo/topology.py", line 583, in _check_implicit_session_support
    self._check_session_support()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/ubuntu/.local/lib/python3.13/site-packages/pymongo/topology.py", line 599, in _check_session_support
    self._select_servers_loop(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        readable_server_selector, self.get_server_selection_timeout(), None
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/ubuntu/.local/lib/python3.13/site-packages/pymongo/topology.py", line 269, in _select_servers_loop
    raise ServerSelectionTimeoutError(
        f"{self._error_message(selector)}, Timeout: {timeout}s, Topology Description: {self.description!r}"
    )
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 111] Connection refused, Timeout: 10.0s, Topology Description: <TopologyDescription id: 68a175a33f50d1776ad3c684, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused')>]>

ERROR:    Application startup failed. Exiting.
