/*! For license information please see main.53abba67.js.LICENSE.txt */
(()=>{"use strict";var e={509:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});var s=n(43),a=n(722),r=n(579);const i="".concat("https://a6b85680-bfc3-4195-a454-dcbbcf45b5c6.preview.emergentagent.com","/api"),nl=e=>{let{onLogin:t}=e;const[n,a]=(0,s.useState)(!0),[o,c]=(0,s.useState)({email:"",password:"",username:"",gender:"male"}),[d,u]=(0,s.useState)(!1);return(0,l.jsx)("div",{className:"min-h-screen bg-gradient-primary flex items-center justify-center p-8",children:(0,l.jsxs)("div",{className:"bg-surface-card border border-border-primary rounded-xl p-8 max-w-md w-full",children:[(0,l.jsx)("h1",{className:"font-russo text-3xl text-accent-primary text-center mb-2",children:"GemPlay"}),(0,l.jsx)("p",{className:"font-roboto text-text-secondary text-center mb-6",children:"PvP NFT Gem Battle Game"}),(0,l.jsxs)("div",{className:"flex mb-6",children:[(0,l.jsx)("button",{onClick:()=>a(!0),className:"flex-1 py-2 px-4 rounded-l-lg font-rajdhani font-bold transition-colors ".concat(n?"bg-accent-primary text-white":"bg-surface-sidebar text-text-secondary"),children:"LOGIN"}),(0,l.jsx)("button",{onClick:()=>a(!1),className:"flex-1 py-2 px-4 rounded-r-lg font-rajdhani font-bold transition-colors ".concat(n?"bg-surface-sidebar text-text-secondary":"bg-accent-primary text-white"),children:"REGISTER"})]}),(0,l.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(!0);try{if(n){console.log("\ud83d\udd10 Attempting login for:",o.email);const e=await i.A.post("".concat(tl,"/auth/login"),{email:o.email,password:o.password});console.log("\ud83c\udf89 Login successful. Response:",e.data),localStorage.setItem("token",e.data.access_token),e.data.refresh_token&&(localStorage.setItem("refresh_token",e.data.refresh_token),console.log("\ud83d\udd04 Refresh token saved")),console.log("\ud83d\udcbe Token saved to localStorage"),t(e.data.user)}else{const e=await i.A.post("".concat(tl,"/auth/register"),{username:o.username,email:o.email,password:o.password,gender:o.gender});alert("Registration successful! Verification token: ".concat(e.data.verification_token)),await i.A.post("".concat(tl,"/auth/verify-email"),{token:e.data.verification_token});const n=await i.A.post("".concat(tl,"/auth/login"),{email:o.email,password:o.password});localStorage.setItem("token",n.data.access_token),n.data.refresh_token&&localStorage.setItem("refresh_token",n.data.refresh_token),t(n.data.user)}}catch(r){var s,a;alert((null===(s=r.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.detail)||"An error occurred")}finally{u(!1)}},className:"space-y-4",children:[!n&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("input",{type:"text",placeholder:"Username",value:o.username,onChange:e=>c((0,r.A)((0,r.A)({},o),{},{username:e.target.value})),className:"w-full px-4 py-3 bg-surface-sidebar border border-border-primary rounded-lg text-white font-roboto",required:!0}),(0,l.jsxs)("select",{value:o.gender,onChange:e=>c((0,r.A)((0,r.A)({},o),{},{gender:e.target.value})),className:"w-full px-4 py-3 bg-surface-sidebar border border-border-primary rounded-lg text-white font-roboto",children:[(0,l.jsx)("option",{value:"male",children:"Male"}),(0,l.jsx)("option",{value:"female",children:"Female"})]})]}),(0,l.jsx)("input",{type:"email",placeholder:"Email",value:o.email,onChange:e=>c((0,r.A)((0,r.A)({},o),{},{email:e.target.value})),className:"w-full px-4 py-3 bg-surface-sidebar border border-border-primary rounded-lg text-white font-roboto",required:!0}),(0,l.jsx)("input",{type:"password",placeholder:"Password",value:o.password,onChange:e=>c((0,r.A)((0,r.A)({},o),{},{password:e.target.value})),className:"w-full px-4 py-3 bg-surface-sidebar border border-border-primary rounded-lg text-white font-roboto",required:!0}),(0,l.jsx)("button",{type:"submit",disabled:d,className:"w-full py-3 bg-gradient-accent text-white font-rajdhani font-bold text-lg rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:d?"LOADING...":n?"LOGIN":"REGISTER"})]})]})})};const sl=function(){const[e,t]=(0,s.useState)(null),[n,a]=(0,s.useState)("lobby"),[r,o]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!0),[h,x]=(0,s.useState)(!1);(0,s.useEffect)((()=>{m()}),[]);const m=async()=>{const e=localStorage.getItem("token"),n=localStorage.getItem("refresh_token");if(console.log("\ud83d\udd0d Checking auth status. Token exists:",!!e,"Refresh token exists:",!!n),e)try{console.log("\ud83d\udce1 Making request to /api/auth/me with token:",e.substring(0,20)+"...");const n=await i.A.get("".concat(tl,"/auth/me"),{headers:{Authorization:"Bearer ".concat(e)}});console.log("\u2705 Auth check successful. User:",n.data),t(n.data)}catch(l){var s,a,r;if(console.error("\u274c Auth check failed:",null===(s=l.response)||void 0===s?void 0:s.status,(null===(a=l.response)||void 0===a?void 0:a.data)||l.message),401===(null===(r=l.response)||void 0===r?void 0:r.status)&&n){console.log("\ud83d\udd04 Attempting to refresh token...");try{const e=await i.A.post("".concat(tl,"/auth/refresh?refresh_token=").concat(n));return console.log("\u2705 Token refreshed successfully"),localStorage.setItem("token",e.data.access_token),e.data.refresh_token&&localStorage.setItem("refresh_token",e.data.refresh_token),void t(e.data.user)}catch(c){var o;console.error("\u274c Token refresh failed:",(null===(o=c.response)||void 0===o?void 0:o.data)||c.message)}}console.log("\ud83d\uddd1\ufe0f Removing invalid tokens"),localStorage.removeItem("token"),localStorage.removeItem("refresh_token")}else console.log("\ud83d\udd12 No token found in localStorage");u(!1)},f=e=>{console.log("\ud83d\ude80 handleLogin called with userData:",e),t(e),console.log("\u2705 User state updated")};return c?(0,l.jsx)("div",{className:"min-h-screen bg-gradient-primary flex items-center justify-center",children:(0,l.jsx)("div",{className:"text-white text-xl font-roboto",children:"Loading..."})}):e?(0,l.jsx)(_,{children:(0,l.jsx)(p,{children:r?(0,l.jsx)(Zo,{user:e,onClose:()=>{o(!1)}}):(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-primary flex",children:[(0,l.jsx)("div",{className:"hidden md:block",children:(0,l.jsx)(d,{currentView:n,setCurrentView:a,user:e,isCollapsed:h,setIsCollapsed:x,onOpenAdminPanel:()=>{o(!0)},onLogout:()=>{localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),t(null),a("lobby"),o(!1)}})}),(0,l.jsxs)("div",{className:"flex-1 flex flex-col min-h-screen",children:[(0,l.jsx)("nav",{className:"sticky top-0 z-40 bg-surface-sidebar border-b border-border-primary p-4 flex-shrink-0",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"hidden md:block",children:(0,l.jsx)("h1",{className:"text-xl font-russo text-text-primary capitalize",children:"my-bets"===n?"My Bets":"game-lobby"===n?"Game Lobby":"create-game"===n?"Create Game":"notification-demo"===n?"Notification Demo":n})}),(0,l.jsx)("div",{className:"md:hidden"}),(0,l.jsx)("div",{className:"block",children:(0,l.jsx)(B,{user:e})}),(0,l.jsx)("div",{className:"md:hidden ml-2",children:(0,l.jsx)("button",{onClick:()=>a("profile"),className:"w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 ".concat("profile"===n?"bg-gradient-to-r from-green-600 to-green-700 ring-2 ring-accent-primary":"bg-gradient-to-r from-green-600 to-green-700 hover:ring-2 hover:ring-accent-primary/50"),children:(0,l.jsx)("span",{className:"font-russo text-white text-sm",children:e.username.charAt(0).toUpperCase()})})})]})}),(0,l.jsx)("div",{className:"flex-1 overflow-auto pb-20 md:pb-0",children:(0,l.jsxs)("div",{className:"min-w-0 px-4 md:px-0",children:["lobby"===n&&(0,l.jsx)(R,{user:e,onUpdateUser:m,setCurrentView:a}),"my-bets"===n&&(0,l.jsx)(I,{user:e,onUpdateUser:m}),"profile"===n&&(0,l.jsx)(W,{user:e,onUpdateUser:m,setCurrentView:a}),"shop"===n&&(0,l.jsx)(U,{user:e,onUpdateUser:m}),"inventory"===n&&(0,l.jsx)(G,{user:e,onUpdateUser:m}),"create-game"===n&&(0,l.jsx)(ie,{user:e,onUpdateUser:m}),"game-lobby"===n&&(0,l.jsx)(le,{user:e,onUpdateUser:m}),"leaderboard"===n&&(0,l.jsx)(Q,{user:e,onUpdateUser:m}),"history"===n&&(0,l.jsx)(X,{user:e,onUpdateUser:m}),"notification-demo"===n&&("ADMIN"===e.role||"SUPER_ADMIN"===e.role)&&!1,"monitoring"===n&&("ADMIN"===e.role||"SUPER_ADMIN"===e.role)&&(0,l.jsx)(s.Suspense,{fallback:(0,l.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,l.jsx)("div",{className:"text-white text-xl font-roboto",children:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438..."})}),children:(0,l.jsx)(el,{user:e})})]})})]}),(0,l.jsx)("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-surface-sidebar border-t border-border-primary",children:(0,l.jsxs)("div",{className:"flex items-center justify-around py-2 px-4",children:[(0,l.jsx)("button",{onClick:()=>a("lobby"),className:"flex flex-col items-center py-2 px-3 rounded-lg transition-all duration-300 ".concat("lobby"===n?"text-accent-primary bg-accent-primary/10":"text-gray-400 hover:text-white"),children:(0,l.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),(0,l.jsx)("button",{onClick:()=>a("my-bets"),className:"flex flex-col items-center py-2 px-3 rounded-lg transition-all duration-300 ".concat("my-bets"===n?"text-accent-primary bg-accent-primary/10":"text-gray-400 hover:text-white"),children:(0,l.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"})})}),(0,l.jsx)("button",{onClick:()=>a("shop"),className:"flex flex-col items-center py-2 px-3 rounded-lg transition-all duration-300 ".concat("shop"===n?"text-accent-primary bg-accent-primary/10":"text-gray-400 hover:text-white"),children:(0,l.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l-1 12H6L5 9z"})})}),(0,l.jsx)("button",{onClick:()=>a("inventory"),className:"flex flex-col items-center py-2 px-3 rounded-lg transition-all duration-300 ".concat("inventory"===n?"text-accent-primary bg-accent-primary/10":"text-gray-400 hover:text-white"),children:(0,l.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),(0,l.jsx)("button",{onClick:()=>a("leaderboard"),className:"flex flex-col items-center py-2 px-3 rounded-lg transition-all duration-300 ".concat("leaderboard"===n?"text-accent-primary bg-accent-primary/10":"text-gray-400 hover:text-white"),children:(0,l.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]})}),(0,l.jsx)(Xo,{})]})})}):(0,l.jsx)(nl,{onLogin:f})};a.createRoot(document.getElementById("root")).render((0,l.jsx)(s.StrictMode,{children:(0,l.jsx)(sl,{})}))})();
//# sourceMappingURL=main.53abba67.js.map