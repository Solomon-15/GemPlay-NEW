/*! For license information please see main.37f47127.js.LICENSE.txt */
(()=>{var e={318:()=>{if("undefined"!==typeof window&&window.ethereum){if(console.log("\u26a0\ufe0f MetaMask detected - blocking automatic connection"),window.ethereum.connect&&(window.ethereum.connect=function(){return console.log("\ud83d\udeab MetaMask connection blocked"),Promise.reject(new Error("MetaMask connection disabled"))}),window.ethereum.on){const e=window.ethereum.on;window.ethereum.on=function(t,a){if("connect"!==t&&"accountsChanged"!==t)return e.call(this,t,a);console.log('\ud83d\udeab MetaMask event "'.concat(t,'" blocked'))}}if(window.ethereum.request){const e=window.ethereum.request;window.ethereum.request=function(t){return t&&"eth_requestAccounts"===t.method?(console.log("\ud83d\udeab MetaMask account request blocked"),Promise.reject(new Error("MetaMask account request disabled"))):e.call(this,t)}}}console.log("\u2705 MetaMask blocker loaded")},4:(e,t,a)=>{"use strict";var n=a(853),s=a(43),r=a(950);function i(e){var t="https://39671358-620a-4bc2-9002-b6bfa47a1383.preview.emergentagent.com","/api"),vu=e=>{let{onLogin:a}=e;const[n,s]=(0,t.useState)(!0),[r,i]=(0,t.useState)({email:"",password:"",username:"",gender:"male"}),[o,c]=(0,t.useState)(!1);return(0,Pt.jsx)("div",{className:"min-h-screen bg-gradient-primary flex items-center justify-center p-8",children:(0,Pt.jsxs)("div",{className:"bg-surface-card border border-border-primary rounded-xl p-8 max-w-md w-full",children:[(0,Pt.jsxs)("div",{className:"flex flex-col items-center mb-2",children:[(0,Pt.jsx)("img",{src:"/gems/gem-green.svg",alt:"GemPlay Logo",className:"w-16 h-16 mb-4"}),(0,Pt.jsx)("h1",{className:"font-russo text-3xl text-accent-primary text-center",children:"GemPlay"})]}),(0,Pt.jsx)("p",{className:"font-roboto text-text-secondary text-center mb-6",children:"PvP NFT Gem Battle Game"}),(0,Pt.jsxs)("div",{className:"flex mb-6",children:[(0,Pt.jsx)("button",{onClick:()=>s(!0),className:"flex-1 py-2 px-4 rounded-l-lg font-rajdhani font-bold transition-colors ".concat(n?"bg-accent-primary text-white":"bg-surface-sidebar text-text-secondary"),children:"LOGIN"}),(0,Pt.jsx)("button",{onClick:()=>s(!1),className:"flex-1 py-2 px-4 rounded-r-lg font-rajdhani font-bold transition-colors ".concat(n?"bg-surface-sidebar text-text-secondary":"bg-accent-primary text-white"),children:"REGISTER"})]}),(0,Pt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),c(!0);try{if(n){console.log("\ud83d\udd10 Attempting login for:",r.email);const e=await At.post("".concat(yu,"/auth/login"),{email:r.email,password:r.password});console.log("\ud83c\udf89 Login successful. Response:",e.data),localStorage.setItem("token",e.data.access_token),e.data.refresh_token&&(localStorage.setItem("refresh_token",e.data.refresh_token),console.log("\ud83d\udd04 Refresh token saved")),console.log("\ud83d\udcbe Token saved to localStorage"),a(e.data.user)}else{const e=await At.post("".concat(yu,"/auth/register"),{username:r.username,email:r.email,password:r.password,gender:r.gender});alert("Registration successful! Verification token: ".concat(e.data.verification_token)),await At.post("".concat(yu,"/auth/verify-email"),{token:e.data.verification_token});const t=await At.post("".concat(yu,"/auth/login"),{email:r.email,password:r.password});localStorage.setItem("token",t.data.access_token),t.data.refresh_token&&localStorage.setItem("refresh_token",t.data.refresh_token),a(t.data.user)}}catch(i){var t,s;alert((null===(t=i.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.detail)||"An error occurred")}finally{c(!1)}},className:"space-y-4",children:[!n&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("input",{type:"text",placeholder:"Username",value:r.username,onChange:e=>i(l(l({},r),{},{username:e.target.value})),className:"w-full px-4 py-3 bg-surface-sidebar border border-border-primary rounded-lg text-white font-roboto",required:!0}),(0,Pt.jsxs)("select",{value:r.gender,onChange:e=>i(l(l({},r),{},{gender:e.target.value})),className:"w-full px-4 py-3 bg-surface-sidebar border border-border-primary rounded-lg text-white font-roboto",children:[(0,Pt.jsx)("option",{value:"male",children:"Male"}),(0,Pt.jsx)("option",{value:"female",children:"Female"})]})]}),(0,Pt.jsx)("input",{type:"email",placeholder:"Email",value:r.email,onChange:e=>i(l(l({},r),{},{email:e.target.value})),className:"w-full px-4 py-3 bg-surface-sidebar border border-border-primary rounded-lg text-white font-roboto",required:!0}),(0,Pt.jsx)("input",{type:"password",placeholder:"Password",value:r.password,onChange:e=>i(l(l({},r),{},{password:e.target.value})),className:"w-full px-4 py-3 bg-surface-sidebar border border-border-primary rounded-lg text-white font-roboto",required:!0}),(0,Pt.jsx)("button",{type:"submit",disabled:o,className:"w-full py-3 bg-gradient-accent text-white font-rajdhani font-bold text-lg rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:o?"LOADING...":n?"LOGIN":"REGISTER"})]})]})})};const ju=function(){const[e,a]=(0,t.useState)(null),[n,s]=(0,t.useState)("lobby"),[r,i]=(0,t.useState)(!1),[o,l]=(0,t.useState)(!0),[c,d]=(0,t.useState)(!1);(0,t.useEffect)((()=>{u()}),[]);const u=async()=>{const e=localStorage.getItem("token"),t=localStorage.getItem("refresh_token");if(console.log("\ud83d\udd0d Checking auth status. Token exists:",!!e,"Refresh token exists:",!!t),e)try{console.log("\ud83d\udce1 Making request to /api/auth/me with token:",e.substring(0,20)+"...");const t=await At.get("".concat(yu,"/auth/me"),{headers:{Authorization:"Bearer ".concat(e)}});console.log("\u2705 Auth check successful. User:",t.data),a(t.data)}catch(o){var n,s,r;if(console.error("\u274c Auth check failed:",null===(n=o.response)||void 0===n?void 0:n.status,(null===(s=o.response)||void 0===s?void 0:s.data)||o.message),401===(null===(r=o.response)||void 0===r?void 0:r.status)&&t){console.log("\ud83d\udd04 Attempting to refresh token...");try{const e=await At.post("".concat(yu,"/auth/refresh?refresh_token=").concat(t));return console.log("\u2705 Token refreshed successfully"),localStorage.setItem("token",e.data.access_token),e.data.refresh_token&&localStorage.setItem("refresh_token",e.data.refresh_token),void a(e.data.user)}catch(c){var i;console.error("\u274c Token refresh failed:",(null===(i=c.response)||void 0===i?void 0:i.data)||c.message)}}console.log("\ud83d\uddd1\ufe0f Removing invalid tokens"),localStorage.removeItem("token"),localStorage.removeItem("refresh_token")}else console.log("\ud83d\udd12 No token found in localStorage");l(!1)},h=e=>{console.log("\ud83d\ude80 handleLogin called with userData:",e),a(e),console.log("\u2705 User state updated")},x=()=>{console.log("\ud83d\udd13 Opening admin panel. Current user:",e),console.log("\ud83d\udd0d Token exists:",!!localStorage.getItem("token")),i(!0)},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),a(null),s("lobby"),i(!1)};return o?(0,Pt.jsx)("div",{className:"min-h-screen bg-gradient-primary flex items-center justify-center",children:(0,Pt.jsx)("div",{className:"text-white text-xl font-roboto",children:"Loading..."})}):e?(0,Pt.jsx)(ra,{children:(0,Pt.jsx)(Wt,{children:r?(0,Pt.jsx)(gu,{user:e,onClose:()=>{i(!1)}}):(0,Pt.jsxs)("div",{className:"min-h-screen bg-gradient-primary flex",children:[(0,Pt.jsx)("div",{className:"hidden md:block",children:(0,Pt.jsx)(Ot,{currentView:n,setCurrentView:s,user:e,isCollapsed:c,setIsCollapsed:d,onOpenAdminPanel:x,onLogout:m})}),(0,Pt.jsxs)("div",{className:"flex-1 flex flex-col min-h-screen",children:[(0,Pt.jsx)("nav",{className:"sticky top-0 z-40 bg-surface-sidebar border-b border-border-primary p-4 flex-shrink-0 hidden md:block",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsx)("div",{className:"block",children:(0,Pt.jsx)("h1",{className:"text-xl font-russo text-text-primary capitalize",children:"my-bets"===n?"My Bets":"game-lobby"===n?"Game Lobby":"create-game"===n?"Create Game":n})}),(0,Pt.jsx)("div",{className:"block",children:(0,Pt.jsx)(ka,{user:e})})]})}),(0,Pt.jsx)(bu,{currentView:n,setCurrentView:s,user:e,onOpenAdminPanel:x,onLogout:m,totalBalance:e?(e.virtual_balance||0)+(e.frozen_balance||0):0}),(0,Pt.jsx)("div",{className:"flex-1 overflow-auto pb-20 md:pb-0",children:(0,Pt.jsxs)("div",{className:"min-w-0 px-4 md:px-0",children:["lobby"===n&&(0,Pt.jsx)(ja,{user:e,onUpdateUser:u,setCurrentView:s}),"my-bets"===n&&(0,Pt.jsx)(Na,{user:e,onUpdateUser:u}),"profile"===n&&(0,Pt.jsx)(Ma,{user:e,onUpdateUser:u,setCurrentView:s,onOpenAdminPanel:x,onLogout:m}),"shop"===n&&(0,Pt.jsx)(Ea,{user:e,onUpdateUser:u}),"inventory"===n&&(0,Pt.jsx)(za,{user:e,onUpdateUser:u}),"create-game"===n&&(0,Pt.jsx)(Ga,{user:e,onUpdateUser:u}),"game-lobby"===n&&(0,Pt.jsx)(Qa,{user:e,onUpdateUser:u}),"leaderboard"===n&&(0,Pt.jsx)(Ra,{user:e,onUpdateUser:u}),"history"===n&&(0,Pt.jsx)(Da,{user:e,onUpdateUser:u})]})})]}),(0,Pt.jsx)("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-surface-sidebar border-t border-border-primary",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-around py-2 px-4",children:[(0,Pt.jsx)("button",{onClick:()=>s("lobby"),className:"flex flex-col items-center py-2 px-3 rounded-lg transition-all duration-300 ".concat("lobby"===n?"text-accent-primary bg-accent-primary/10":"text-gray-400 hover:text-white"),children:(0,Pt.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),(0,Pt.jsx)("button",{onClick:()=>s("my-bets"),className:"flex flex-col items-center py-2 px-3 rounded-lg transition-all duration-300 ".concat("my-bets"===n?"text-accent-primary bg-accent-primary/10":"text-gray-400 hover:text-white"),children:(0,Pt.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"})})}),(0,Pt.jsx)("button",{onClick:()=>s("shop"),className:"flex flex-col items-center py-2 px-3 rounded-lg transition-all duration-300 ".concat("shop"===n?"text-accent-primary bg-accent-primary/10":"text-gray-400 hover:text-white"),children:(0,Pt.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l-1 12H6L5 9z"})})}),(0,Pt.jsx)("button",{onClick:()=>s("inventory"),className:"flex flex-col items-center py-2 px-3 rounded-lg transition-all duration-300 ".concat("inventory"===n?"text-accent-primary bg-accent-primary/10":"text-gray-400 hover:text-white"),children:(0,Pt.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),(0,Pt.jsx)("button",{onClick:()=>s("leaderboard"),className:"flex flex-col items-center py-2 px-3 rounded-lg transition-all duration-300 ".concat("leaderboard"===n?"text-accent-primary bg-accent-primary/10":"text-gray-400 hover:text-white"),children:(0,Pt.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]})}),(0,Pt.jsx)(hu,{})]})})}):(0,Pt.jsx)(vu,{onLogin:h})};n.createRoot(document.getElementById("root")).render((0,Pt.jsx)(t.StrictMode,{children:(0,Pt.jsx)(ju,{})}))})()})();
//# sourceMappingURL=main.37f47127.js.map